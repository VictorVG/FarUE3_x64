Скрипты управления и макросы плагина.

1 Макросы плагина.

Вместе с плагином поставляются скрипты управления содержащие макросы позволяющие
упростить некоторые часто используемые операции. Они расположены в подкаталоге
Scripts плагина в двух Lua скриптах:

IntChecker.Run.lua - этот скрипт содержит макросы:

 - вызов основного меню плагина по Alt-H;

- запуск проверки целостности файлов по имеющемуся файлу хэшей который может
быть записан в одном из распознаваемых плагином форматов:

 GNU       : <hash> *<path>
   или
 BSD (UNIX): <alg> (<path>) = <hash>

где, <hash> - значение хэша;
     <path> - путь к файлу для которого вычислен хэш;
     <alg> - имя алгоритма, используется только в BSD (UNIX) формате записи.

Имена файлов хэшей должны иметь расширение в зависимости от алгоритма:

   CRC-32 - .sfv; MD5 - .md5; SHA1 - .sha1; SHA-256 - .sha256;
   SHA-512 - .sha512; SHA3-512 - .sha3 и для Whirlpool - .wrpl

этот макрос запускается либо по Enter либо по нажатию колеса мыши или
средней кнопки мыши.

В макрос встроена проверка на условие "Командная строка пуста?" - если курсор
стоит на хэшфайле и командная строка не пустая, то макрос спросит вас что
сделать:

 при нажатии OK - будет запущена набранная в командной строке команда;
 при нажатии Cancel - будет проверена целостность указанных в хэшфайле объектов

Оговорка: По умолчанию выполнение команды считается более важной задачей.

Примечание:

Существуют и другие криптографические алгоритмы длина хэша у которых совпадает
с поддерживаемыми плагином, но если вы решите проверить с их помощью файлы, то
даже при корректном формате хэшфайла получите сообщение плагина "Файл не
является списком хешей", а дальше будете долго и мучительно пытаться понять
почему плагин его отвергает?

- пошаговый мастер вычисления хэша запускаемый по Alt-G.

Мастер позволяет выбрать режим вычисления хэшей для файла под курсором,
выбранных или всех файлов в текущем каталоге, рекурсивно для текущего каталога
или произвольного UNC пути (выводится запрос). Если введён UNC путь, то
производится диагности доступности целевого объекта и если он доступен, то
если путь указывает на файл, то хэш считается только для него, иначе считаются
хэши для всех файлов в указанном каталоге и его подкаталогах.

Вычисленный хэш можно вывести на экран, либо скопировать его в буфер обмена
ОС, или записать в файл.

В режиме "UNC path" каталог для сохранения хэш файла выбирается по простому
правилу:

если указан каталог то сохраняем в него, иначе в каталог с указанным файлом.

В остальных случаях хэш файл всегда сохраняется в текущий каталог на активной
панели.

Сообщения плагина Integrity Checker об ошибках отключены - скрипт сам
разбирается с доступностью объектов.

Для операций копирования в буфер обмена или записи в файл вы можете выбрать
любой из двух форматов выходной строки - GNU или BSD (UNIX).

Доступные на текущем шаге мастера хоткеи выводятся в заголовке его поля ввода,
регистр символов игнорируется. Каталоги при расчёте хэша пропускаются, в вывод
мастера попадают только файлы, если они находятся в подкаталоге, то для них
указывается относительный путь.

Например:

 SHA-256 (test.txt) = <SHA256SUM>
 SHA-256 (Cat\test.txt) = <SHA256SUM>

2. Демо-скрипт IntChecker.GetFileHash.lua

Этот скрипт содержит учебный пример вызова плагина из макросов.

3. Установка макросов.

Установка макросов аналогична другим макросам в Far3 - скопируйте выбранный
файл скрипта в каталог скриптов Far (путь к нему настраивается в Far.exe.ini)
и перезапустите Far, либо если у вас установлен скрипт перезагрузки макросов,
например ReloadMacros.lua можно с его помощью перезагрузить макросы. Главное,
чтобы Far обновил внутренний список доступных в данный момент макросов и тогда
они будут у вас работать.