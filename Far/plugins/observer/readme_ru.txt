Observer
Плагин для FAR 1.75+ / 2.0+ / 3.0+
Автор: Ariman

-------------------------------------------------------------------

1. Общее описание.

Плагин предназначен для просмотра и извлечения содержимого разнообразных файловых контейнеров.
Операции добавления/удаления/изменения файлов не предусмотрены.

1.1. Поддерживаемые форматы:

- Инсталляционные пакеты
  - Инсталляторы, сделаные с помощью системы NSIS
  - MSI пакеты для Windows Installer-а
  - Инсталляционные пакеты, сделаные Wise Installer-ом.
  - Инсталляторы Install Shield-а.
  - Инсталляторы Setup Factory.
  - Инсталляторы CreateInstall.

- Образы оптических дисков (CD/DVD/Blu-ray)
  - ISO-образы. Поддерживаются следующие файловые системы:
    - ISO-9660 (incl. Joliet, RockRidge)
    - UDF (ISO 13346) до версии 2.60 включительно
  - NRG-образ Nero Burning ROM
  - BIN-образ CDRWIN (CUE/BIN)
  - MDF-образ Alcohol 120% (MDF/MDS)
  - ISZ-образ UltraISO

- Образы дисков виртуальных машин
  - VMDK (VMware)
  - VDI  (Virtual Box)
  - VHD  (Microsoft Virtual PC)
  - XVA  (Xen Virtual Appliance)

- MIME
  - MIME контейнеры (.eml, .mht, etc.)
  - Базы MS Outlook (*.pst)
  - Контейнеры MBox
  - Базы The Bat! (*.tbb)

- Архивы-контейнеры, применяемые в различных играх
  - CAT, PCK, PBD, PBB - используются Egosoft для игр серии X
  - VP - Volition Pack V2 (для игр FreeSpace 1/2/Open)
  - BIG, SGA - контейнеры из игр компании Relic (Homeworld 1/2, CoH, WH40k DoW 1/2)
  - GCF, WAD, XZP, PAK, BSP, VBSP - используются в системе Steam
  - MoPaQ архивы (используются Blizzard)

- Другое
  - Встроенные файлы из PDF.

- Поддерживается использование WCX модулей от Total Commander-а в режиме чтения

1.2. Настройки.

Некоторые опции плагина недоступны из диалога настроек.
Они могут быть сконфигурированы через файл observer.ini в каталоге плагина.

Также плагин поддерживает пользовательский файл конфигурации observer_user.ini.
Этот файл может быть полезен, если, по каким либо причинам, редактирование основного файла,
который поставляется в дистрибутиве, является нежелательным.
Структура файла observer_user.ini является аналогичной как и для observer.ini. Значения из
пользовательского файла имеют приоритет по сравнению со значениями основного файла настроек.

Значения из файла observer_user.ini дополняют и перезаписывают значения из observer.ini.
Комментарии игнорируются для обоих файлов. Комментирование настройки в observer_user.ini
не приведет к отмене настройки из observer.ini.

Настройки основного плагина находятся в секции [General].
Настройки для каждого отдельного модуля находятся в секции с именем соотвествующего модуля.

Список подгружаемых модулей находится в секции [Modules].
Модули подгружаются и опрашиваются при открытии файла в порядке, в котором они перечислены.
Чтобы плагин увидел модуль, его обязательно надо прописать в данной секции.

Чтобы запретить загрузку модуля в файле observer_user.ini, надо поставить "-" (без кавычек)
вместо пути к файлу.

Примечание: Для per-user настроек плагина можно создать значение с таким же именем ключа
в реестре в ветке настроек плагина. Действует только для секции [General].
Значение из реестра перекрывает значение из ini файла.

На данный момент доступны следующие опции:

1.2.1 Общие настройки.

[General] -> PanelHeaderPrefix
Здесь можно задать строку, которая будет выводиться в заголовке файловой панели перед именем модуля. 
Действут для всех модулей одновременно. Максимальная длина строки 32 символа.
Строки большей длины будут проигнорированы.

[General] -> ExtendedCurDir
Данное значение регулирует формат значения текущей директории, которое плагин отдает FAR-у.
Расширенный формат позволяет использовать функционал "Folders History" для навигации внутри контейнеров.
Допустимые значения: 1 (расширеный формат включен) и 0 (используется стандартный формат).
ВНИМАНИЕ:
Данный метод использует недокументированные особенности обработки FAR-ом значения текущей директории,
поэтому может иметь неожиданные побочные эффекты или вообще прекратить работать с очередным обновлением.

[General] -> VerboseModuleLoad
Включает показ сообщения на старте плагина, если какие-либо модули не загрузились.
Допустимые значения: 1 (показывать сообщение) or 0 (не показывать).

1.2.2 Фильтры.

[Filters]
Эта секция задает маски по расширению для модулей, чтобы ускорить обработку файлов.
Фильтры работают только при входе в файл через Enter или PgDn. При использовании
меню плагинов (F11) или префикса фильтры игнорируются.
Значения задаются в формате: ModuleName=.ext1;.ext2;.ext3
Имена модулей беруться из сеции [Modules] с учётом регистра. Расширения в списке
отделяются точкой с запятой и имеют точку впереди. Регистр букв не учитывается.
Если для какого-либо модуля не задан фильтр или он пустой, то считается, что модуль принимает любые файлы.

1.2.3 Настройки для модулей.

Варианты помеченные * являются значениями по умолчанию.

[ISO] -> Charset
[VDISK] -> DefaultCodepage
Значение кодовой страницы по умолчанию для неюникодных имен файлов.
Можно ставить конкретный номер кодовой страницы (напр. 866 или 1251),
или можно использовать системные значения:
1 - текущая OEM страница (значение по умолчанию),
0 - текущая ANSI страница

[ISO] -> RockRidge
Включает (1*) / выключает (0) поддержку расширения RockRidge. По умолчанию включено.

[PST] -> HideEmptyFolder
Включает (1) / выключает (0*) скрывание пустых каталогов.

[WCX] -> WcxLocation
Полный путь где искать .wcx файлы. По умолчанию поиск идет в папке "wcx" (без кавычек) рядом с файлом модуля.
[WCX] -> RecursiveLoad
Включает (1*) / выключает (0) рекурсивное сканирование каталогов при поиске wcx файлов.

1.2.4 Горячие клавиши выбора модуля.

[Shortcuts]
Здесь можно задать горячи клавиши дя меню выбора модуля при открытие файла.
Допустимые значения - цифры и буквы от 'A' до 'Z'. Регистр букв значения не имеет.

1.3 Диалог конфигурации плагина.

В отличии от настроек, описанных в пункте 1.2, которые применяются только при запуске,
некоторые параметры работы плагина можно изменить через диалог конфигурации
(F9 -> Options -> Plugins Configuration). Эти параметры применяются сразу после закрытия
окна диалога (если не нажать 'Отмена' или Esc). Здесь можно настроить следующие параметры:

- Вкл./выкл. обработку плагином Ctrl-PgDn (вызов плагина всегда доступен по F11).
- Настроить префикс плагина (по умолчанию значение префикса 'observe').
- Вкл./выкл. использование фильтров по расширению (см. 1.2.2 выше).

2. Лицензия и авторские права.

Плагин включает в себя код других авторов, с некоторыми изменениями.
Распространияется под GNU LGPL версии 3 или выше
(исключая код, для которого указана специальная лицензия).

Используемый сторонний код:

- 7-zip (http://www.7-zip.org)
Взята поддержка UDF + NSIS. Распространяется по лицензии GNU LGPL.

- Total Commander ISO plugin by Sergey Oblomov (http://wincmd.ru/plugring/iso.html)
Передалан на поддержку wchar_t в именах.
Лицензии на код не нашел, поэтому тоже пойдет по LGPL.

- libmspack (http://www.cabextract.org.uk/libmspack/)
libmspack is a library which provides compressors and decompressors,
archivers and dearchivers for Microsoft compression formats.

- X2 FileDriver (http://x-tools.doubleshadow.wz.cz/)
Поддержка архивов Egosoft (X2, X3, X3:TC).

- Homeworld 1 Source Code (http://www.relic.com)
Распаковка файлов для Homeworld 1 вырезана из публичного исходного кода игры.

- PST File Format SDK (http://pstsdk.codeplex.com)
Кроссплатформенная C++ библиотека для чтения файлов формата PST (от MS Outlook).
Распространяется под лицензией Apache License 2.0.

- Wise UNpacker by J.Markus/Icebird
Код использовался в качестве ориентира. Небольшая часть кода является прямым портом из Delphi в C++.

- HLLib (http://nemesis.thewavelength.net/index.php?p=35)
Бибилотека для Half-Life которая абстрагирует несколько пакетных форматов и предоставляет простой интерфейс для доступа к ним.
Распространяется по лицензии GNU LGPL.

- DiscUtils (http://discutils.codeplex.com/)
Библиотека для чтения и записи файлов ISO и образов жестких дисков для виртуальных машин (VHD, VDI, XVA, VMDK, etc).
Распространяется по лицензии MIT.

- StormLib (http://www.zezula.net/en/mpq/stormlib.html)
Библиотека для чтения/записи MPQ архивов.

- GMime (http://spruce.sourceforge.net/gmime/)
GMime is a C/C++ library which may be used for the creation and parsing of messages using the Multipurpose Internet Mail Extension (MIME).
Распространяется по лицензии GNU LGPL.

- zlib (http://www.zlib.net)
zlib это библиотека для сжатия данных без потерь.

- libbzip2 (http://bzip.org)
bzip2 это свободная библиотека для сжатия данных.

- i5comp (ftp://ftp.elf.stuba.sk/pub/pc/pack/i5comp21.rar)
InstallShield 5.x Cabinet Compression & Maintenance Util by fOSSiL.

- i6comp (ftp://ftp.elf.stuba.sk/pub/pc/pack/i6comp02.zip)
InstallShield 6.x Cabinet Util by fOSSiL & Morlac.

- i6compx (http://www.ctpax-x.org/uploads/i6compx.zip)
Исправленная i6comp для поддержки Юникода.

- unshield (https://github.com/twogood/unshield)
Утилита из проекта SyncCE.
Распространяется по лицензии MIT.

- poppler (http://poppler.freedesktop.org/)
Библиотека обработки PDF.

3. Системные требования.
OS: WinXP или новее.
Минимальные версии FAR-а для работы плагина 1.75 build 2634 / 2.0 build 1807

Windows Installer 4+
Microsoft Visual C++ 2010 SP1 Redistributable Package

Модуль VDISK дополнительно требует Microsoft .NET Framework 4.0.
Если .NET не установлен, то этот модуль не будет загружаться.

4. Гарантии.
Плагин предоставляется по принципу "AS IS" без каких-либо гарантий,
явных или неявных. Используйте на свой страх и риск. ;-)

5. Контакты.
Сообщения об ошибках, предложения и т.д. отправляйте по адресу ariman@inbox.ru
